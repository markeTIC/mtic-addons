<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>

        <!-- Orden de mantenimiento views -->
        <record id="maintenance_order_list_action" model="ir.actions.act_window">
            <field name="name">Órdenes de mantenimiento</field>
            <field name="res_model">sigma2.maintenance.order</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click para crear una orden de mantenimiento 
                </p>
                <p>
                    Gestión de órdenes de mantenimiento de SIGMa 2.
                </p>
            </field>
        </record>

        <record id="maintenance_order_list_view" model="ir.ui.view">
            <field name="name">Lista de órdenes de mantenimiento</field>
            <field name="model">sigma2.maintenance.order</field>
            <field name="arch" type="xml">
                <tree default_order="date desc" colors="black:color_index == 0; red:color_index == 1; orange:color_index == 2; blue:color_index == 3; lightgreen:color_index == 4; grey:color_index == 5; green:color_index == 6; purple:color_index == 7; magenta:color_index == 8;">
                    <field name="asset_level1"/>
                    <field name="code"/>
                    <field name="date"/>
                    <field name="asigned_employee_id"/>
                    <field name="asset_id"/>
                    <field name="origin_employee_id"/>
                    <field name="work_shift"/>
                    <field name="state"/>
                    <field name="priority"/>
                    <field name="color_index" invisible="1"/>
                </tree>
            </field>
        </record>
		
        <record id="pending_maintenance_order_list_view" model="ir.ui.view">
            <field name="name">Lista de órdenes de mantenimiento pendientes</field>
            <field name="model">sigma2.maintenance.order</field>
            <field name="arch" type="xml">
                <tree default_order="priority, date desc" colors="black:color_index == 0; red:color_index == 1; orange:color_index == 2; blue:color_index == 3; lightgreen:color_index == 4; grey:color_index == 5; green:color_index == 6; purple:color_index == 7; magenta:color_index == 8;">
                    <field name="asset_level1"/>
                    <field name="code"/>
                    <field name="date"/>
                    <field name="asigned_employee_id"/>
                    <field name="asset_id"/>
                    <field name="origin_employee_id"/>
                    <field name="work_shift"/>
                    <field name="state"/>
                    <field name="priority"/>
                    <field name="color_index" invisible="1"/>
                </tree>
            </field>
        </record>

        <record id="finished_maintenance_order_list_view" model="ir.ui.view">
            <field name="name">Lista de órdenes de mantenimiento finalizadas</field>
            <field name="model">sigma2.maintenance.order</field>
            <field name="arch" type="xml">
                <tree default_order="end_date desc" colors="black:color_index == 0; red:color_index == 1; orange:color_index == 2; blue:color_index == 3; lightgreen:color_index == 4; grey:color_index == 5; green:color_index == 6; purple:color_index == 7; magenta:color_index == 8;">
                    <field name="asset_level1"/>
                    <field name="code"/>
                    <field name="date"/>
                    <field name="asigned_employee_id"/>
                    <field name="asset_id"/>
                    <field name="origin_employee_id"/>
                    <field name="state"/>
                    <field name="end_date" string="Fecha fin"/>
                    <field name="repair_time" string="Tiempo rep."/>
                    <field name="stop_time" string="Tiempo paro"/>
                    <field name="color_index" invisible="1"/>
                </tree>
            </field>
        </record>

        <record id="prev_maintenance_order_list_view" model="ir.ui.view">
            <field name="name">Lista de órdenes de mantenimiento</field>
            <field name="model">sigma2.maintenance.order</field>
            <field name="arch" type="xml">
                <tree default_order="asset_id" colors="black:color_index == 0; red:color_index == 1; orange:color_index == 2; blue:color_index == 3; lightgreen:color_index == 4; grey:color_index == 5; green:color_index == 6; purple:color_index == 7; magenta:color_index == 8;">
                    <field name="asset_level1"/>
                    <field name="code"/>
                    <field name="date"/>
                    <field name="asset_id"/>
                    <field name="state"/>
                    <field name="priority"/>
                    <field name="color_index" invisible="1"/>
                    <field name="preventive_barcode" invisible="1"/>
                </tree>
            </field>
        </record>

        <record id="prev_pending_maintenance_order_list_view" model="ir.ui.view">
            <field name="name">Lista de órdenes de mantenimiento pendientes</field>
            <field name="model">sigma2.maintenance.order</field>
            <field name="arch" type="xml">
                <tree default_order="asset_id" colors="black:color_index == 0; red:color_index == 1; orange:color_index == 2; blue:color_index == 3; lightgreen:color_index == 4; grey:color_index == 5; green:color_index == 6; purple:color_index == 7; magenta:color_index == 8;">
                    <field name="asset_level1"/>
                    <field name="code"/>
                    <field name="date"/>
                    <field name="asset_id"/>
                    <field name="state"/>
                    <field name="priority"/>
                    <field name="color_index" invisible="1"/>
                    <field name="preventive_barcode" invisible="1"/>
                </tree>
            </field>
        </record>

        <record id="prev_finished_maintenance_order_list_view" model="ir.ui.view">
            <field name="name">Lista de órdenes de mantenimiento finalizadas</field>
            <field name="model">sigma2.maintenance.order</field>
            <field name="arch" type="xml">
                <tree default_order="end_date desc" colors="black:color_index == 0; red:color_index == 1; orange:color_index == 2; blue:color_index == 3; lightgreen:color_index == 4; grey:color_index == 5; green:color_index == 6; purple:color_index == 7; magenta:color_index == 8;">
                    <field name="asset_level1"/>
                    <field name="code"/>
                    <field name="date"/>
                    <field name="asset_id"/>
                    <field name="end_date" string="Fecha fin"/>
                    <field name="repair_time" string="Tiempo rep."/>
                    <field name="stop_time" string="Tiempo paro"/>
                    <field name="color_index" invisible="1"/>
                    <field name="preventive_barcode" invisible="1"/>
                </tree>
            </field>
        </record>

		<record id="maintenance_order_form_view" model="ir.ui.view">
            <field name="name">Formulario orden de mantenimiento</field>
            <field name="model">sigma2.maintenance.order</field>
            <field name="arch" type="xml">
                <form string="Orden de mantenimiento">
                    <header>
                        <button name="reset_order" string="Pendiente" states="parts,scaled,finished,closed,canceled" class="oe_highlight" groups="sigma2.supervisor_group"/>
                        <button name="reopen_order" string="En curso" states="parts,scaled,finished,closed,canceled" class="oe_highlight" groups="sigma2.supervisor_group"/>
                        <button name="finish_order" string="Finalizar" states="open" class="oe_highlight" groups="sigma2.user_group"/>
                        <button name="validate_order" string="Validar" states="finished" class="oe_highlight" groups="sigma2.supervisor_group"/>
                        <button name="cancel_order" string="Cancelar" states="pending,planned,open,parts,scaled,finished,closed" groups="sigma2.supervisor_group"/>
                        <field name="state" widget="statusbar" statusbar_visible="pending,planned,open,parts,scaled,finished,closed,canceled" statusbar_colors='{"parts":"red","scaled":"red"}' readonly="1"/>
                    </header>
                    <sheet>
                        <div class="oe_right oe_button_box">
                        </div>
                        <div class="oe_title" style="width: 25%%">
                            <h1>
                                <field name="display_name"/>
                            </h1>
                        </div>
                        <group colspan="4">
                            <field name="param_order_type_code" invisible="1"/>
                            <field name="create_date" invisible="1"/>
	                        <group>
	                            <field name="order_type_id" options="{'no_create': True}" attrs="{'invisible':[('param_order_type_code', '!=', False)]}"/>
			                    <field name="code" attrs="{'invisible':[('create_date', '!=', False)]}"/>
	                            <field name="origin_employee_id" options="{'no_create': True}"/>
                                <field name="origin_department_id" readonly="1"/>
	                            <field name="asset_level1" options="{'no_create': True}"/>
	                            <field name="asset_level2" options="{'no_create': True}"/>
	                            <field name="asset_level3" options="{'no_create': True}"/>
	                            <field name="asset_id" invisible="1"/>
	                        </group>
	                        <group>
	                            <field name="date"/>
	                            <field name="work_shift"/>
	                            <field name="priority"/>
	                            <field name="state_date" invisible="1"/>
	                            <field name="state_note" attrs="{'invisible':[('state', '!=', 'canceled'), ('state', '!=', 'rejected')]}"/>
	                            <field name="action_planning_id" attrs="{'invisible':[('action_planning_id', '==', False)]}"/>
	                        </group>
                        </group>
                        <notebook>
                        	 <page string="Descripción">
		                        <group>
		                            <field name="description" nolabel="1" placeholder="Descripción del trabajo" />
		                        </group>
                        	 </page>
                        	 <page string="Trabajadores" attrs="{'invisible':[('create_date', '=', False)]}">
		                        <field name="worker_ids" nolabel="1">
		                        	<tree editable="bottom">
                                        <field name="active" invisible="1"/>
		                        		<field name="employee_id" options="{'no_create': True}"/>
		                        		<field name="start_date"/>
		                        		<field name="work_time"/>
		                        	</tree>
		                        </field>
                        	 </page>
                        	 <page string="Recambios" attrs="{'invisible':[('create_date', '=', False)]}">
		                        <field name="part_ids" nolabel="1">
		                        	<tree editable="bottom">
		                        		<field name="product_id" options="{'no_create': True}"/>
                                        <field name="description"/>
                                        <field name="qty"/>
		                        	</tree>
		                        </field>
                        	 </page>
                        	 <page string="Resultado" attrs="{'invisible':[('create_date', '=', False)]}">
		                        <group>
		                            <field name="solution_description" nolabel="1" placeholder="Resultado del trabajo" />
		                        </group>
		                        <group>
			                        <group>
			                            <field name="start_date"/>
			                            <field name="end_date"/>
			                        </group>
			                        <group>
			                            <field name="repair_time"/>
			                            <field name="stop_time"/>
			                            <field name="stop_time_rated" groups="sigma2.supervisor_group"/>
			                        </group>
		                        </group>
                        	 </page>
                        	 <page string="Notas" attrs="{'invisible':[('create_date', '=', False)]}">
		                        <group>
		                            <field name="notes" nolabel="1" placeholder="Notas" />
		                        </group>
                        	 </page>
                        </notebook>
                        <group>
	                        <group>
	                            <field name="asigned_employee_id" options="{'no_create': True}"/>
	                            <field name="planned_date"/>
	                        </group>
	                        <group>
	                            <field name="authorization_employee_id" options="{'no_create': True}"/>
	                            <field name="validation_employee_id" options="{'no_create': True}"/>
	                        </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="maintenance_order_search_view" model="ir.ui.view">
            <field name="name">sigma2.maintenance.order.search</field>
            <field name="model">sigma2.maintenance.order</field>
            <field name="arch" type="xml">
                <search string="Orden de mantenimiento">
                    <field name="code" filter_domain="['|',('code','ilike',self),('preventive_barcode','ilike',self)]"/>
                    <field name="asset_level1"/>
                    <field name="asset_id"/>
                    <field name="origin_employee_id"/>
                    <field name="origin_department_id"/>
                    <field name="asigned_employee_id"/>
                    <separator/>
                    <filter string="Pendientes" name="filter_pending" domain="[('state','=','pending')]"/>
                    <filter string="Planificadas" name="filter_planned" domain="[('state','=','planned')]"/>
                    <filter string="En curso" name="filter_open" domain="[('state','=','open')]"/>
                    <filter string="Pdte. repuestos" name="filter_parts" domain="[('state','=','parts')]"/>
                    <filter string="Pdte. terceros" name="filter_scaled" domain="[('state','=','scaled')]"/>
                    <filter string="Finalizadas" name="filter_finished" domain="[('state','=','finished')]"/>
                    <filter string="Cerradas" name="filter_closed" domain="[('state','=','closed')]"/>
                    <filter string="Canceladas" name="filter_canceled" domain="[('state','=','canceled')]"/>
                    <filter string="Rechazadas" name="filter_disposed" domain="[('state','=','rejected')]"/>
                    <separator />
                    <filter string="Mis órdenes" name="filter_my_orders" domain="[('asigned_employee_id.user_id','=',uid)]"
                            help="Órdenes que tengo asignadas"/>
                    <filter string="Sin asignar" name="filter_unassigned" domain="[('asigned_employee_id','=', False)]"
                            help="Órdenes sin asignar"/>
                    <separator />
                    <filter string="Preventivo" name="filter_preventive" domain="[('order_type_id.code','=','P')]"/>
                    <filter string="Correctivo" name="filter_corrective" domain="[('order_type_id.code','=','C')]"/>
                    <filter string="Mejora" name="filter_improvement" domain="[('order_type_id.code','=','M')]"/>
                    <filter string="Legal" name="filter_regulatory" domain="[('order_type_id.code','=','L')]"/>
                </search>
            </field>
        </record>

        <record id="prev_maintenance_order_list_action" model="ir.actions.act_window">
            <field name="name">Órdenes de preventivo</field>
            <field name="res_model">sigma2.maintenance.order</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="prev_maintenance_order_list_view"/>
            <field name="search_view_id" ref="maintenance_order_search_view"/>
            <field name="context">{'search_default_filter_preventive': 1, 'default_param_order_type_code': 'P'}</field>
            <field name="limit">100</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click para crear una orden de mantenimiento preventivo
                </p>
                <p>
                    Las órdenes de preventivo se generan automáticamente a partir de las gamas de mantenimiento.
                </p>
            </field>
        </record>

        <record id="pend_prev_maintenance_order_list_action" model="ir.actions.act_window">
            <field name="name">Órdenes preventivo pend.</field>
            <field name="res_model">sigma2.maintenance.order</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="prev_pending_maintenance_order_list_view"/>
            <field name="search_view_id" ref="maintenance_order_search_view"/>
            <field name="context">{'search_default_filter_preventive': 1, 'search_default_filter_pending': 1, 'search_default_filter_planned': 1, 'search_default_filter_open': 1, 'default_param_order_type_code': 'P'}</field>
            <field name="limit">100</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click para crear una orden de mantenimiento preventivo 
                </p>
                <p>
                    Las órdenes de preventivo se generan automáticamente a partir de las gamas de mantenimiento.
                </p>
            </field>
        </record>

        <record id="corr_maintenance_order_list_action" model="ir.actions.act_window">
            <field name="name">Órdenes de correctivo</field>
            <field name="res_model">sigma2.maintenance.order</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="maintenance_order_list_view"/>
            <field name="search_view_id" ref="maintenance_order_search_view"/>
            <field name="context">{'search_default_filter_corrective': 1, 'default_param_order_type_code': 'C'}</field>
            <field name="limit">100</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click para crear una orden de mantenimiento correctivo 
                </p>
                <p>
                    Las órdenes de correctivo se crean cuando surge una incidencia o avería en producción que requiere de la intervención de mantenimiento.
                </p>
            </field>
        </record>

        <record id="pend_corr_maintenance_order_list_action" model="ir.actions.act_window">
            <field name="name">Órdenes correctivo pend.</field>
            <field name="res_model">sigma2.maintenance.order</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="pending_maintenance_order_list_view"/>
            <field name="search_view_id" ref="maintenance_order_search_view"/>
            <field name="context">{'search_default_filter_corrective': 1, 'search_default_filter_pending': 1, 'search_default_filter_planned': 1, 'search_default_filter_open': 1, 'search_default_filter_parts': 1, 'search_default_filter_scaled': 1, 'default_param_order_type_code': 'C'}</field>
            <field name="limit">100</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click para crear una orden de mantenimiento correctivo
                </p>
                <p>
                    Las órdenes de correctivo se crean cuando surge una incidencia o avería en producción que requiere de la intervención de mantenimiento.
                </p>
            </field>
        </record>

        <record id="finished_maintenance_order_list_action" model="ir.actions.act_window">
            <field name="name">Órdenes realizadas</field>
            <field name="res_model">sigma2.maintenance.order</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="finished_maintenance_order_list_view"/>
            <field name="search_view_id" ref="maintenance_order_search_view"/>
            <field name="context">{'search_default_filter_corrective': 1, 'search_default_filter_improvement': 1, 'search_default_filter_finished': 1, 'search_default_filter_closed': 1, 'default_param_order_type_code': 'C'}</field>
            <field name="limit">100</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click para crear una orden de mantenimiento correctivo
                </p>
                <p>
                    Las órdenes de correctivo se crean cuando surge una incidencia o avería en producción que requiere de la intervención de mantenimiento.
                </p>
            </field>
        </record>

        <record id="improv_maintenance_order_list_action" model="ir.actions.act_window">
            <field name="name">Propuestas de mejora</field>
            <field name="res_model">sigma2.maintenance.order</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="maintenance_order_list_view"/>
            <field name="search_view_id" ref="maintenance_order_search_view"/>
            <field name="context">{'search_default_filter_improvement': 1, 'default_param_order_type_code': 'M'}</field>
            <field name="limit">100</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click para crear una propuesta de mejora
                </p>
                <p>
                    Las propuestas de mejora se crean cuando se detecta un punto de mejora en la producción, la máquina, la seguridad o de cualquier otro tipo que se desee canalizar a través de mantenimiento.
                </p>
            </field>
        </record>

        <record id="pend_improv_maintenance_order_list_action" model="ir.actions.act_window">
            <field name="name">Propuestas mejora pend.</field>
            <field name="res_model">sigma2.maintenance.order</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="pending_maintenance_order_list_view"/>
            <field name="search_view_id" ref="maintenance_order_search_view"/>
            <field name="context">{'search_default_filter_improvement': 1, 'search_default_filter_pending': 1, 'search_default_filter_planned': 1, 'search_default_filter_open': 1, 'search_default_filter_parts': 1, 'search_default_filter_scaled': 1, 'default_param_order_type_code': 'M'}</field>
            <field name="limit">100</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click para crear una propuesta de mejora
                </p>
                <p>
                    Las propuestas de mejora se crean cuando se detecta un punto de mejora en la producción, la máquina, la seguridad o de cualquier otro tipo que se desee canalizar a través de mantenimiento.
                </p>
            </field>
        </record>

    </data>
</openerp>
